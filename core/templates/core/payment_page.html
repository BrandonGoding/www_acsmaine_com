{% extends "base.html" %}
{% load static %}
{% block content %}

<!-- Header / breadcrumb -->
<section class="bg-base-200 border-b border-base-300">
  <div class="max-w-7xl mx-auto px-6 py-10">
    <nav aria-label="Breadcrumb" class="text-sm">
      <ol class="flex items-center gap-2 text-base-content/70">
        <li><a href="/" class="link link-hover">Home</a></li>
        <li aria-hidden="true" class="opacity-50">/</li>
        <li class="text-base-content">Payments</li>
      </ol>
    </nav>
    <h1 class="mt-3 text-3xl md:text-4xl font-bold">Payments</h1>
    <p class="mt-2 text-base-content/80">Thank you for your business!</p>
  </div>
</section>

<!-- Content -->
<section class="bg-base-100">
  <div class="max-w-7xl mx-auto px-6 py-12 grid lg:grid-cols-12 gap-10">

    <!-- Left: Preferred payment (checks) + contact -->
    <aside class="lg:col-span-5 space-y-6">
      <div class="card bg-base-200 shadow-sm">
        <div class="card-body">
          <h2 class="card-title">Preferred Method: Check</h2>
          <p class="text-base-content/80 mt-2">
            Please mail checks to:
          </p>
          <address class="not-italic mt-2">
            <div class="font-medium">ACS Electrical Contractors</div>
            PO Box 1628<br>
            Auburn, ME 04211-1628
          </address>
          <p class="mt-4 text-base-content/80">
            Questions or to pay by phone?
          </p>
          <ul class="mt-1 space-y-1">
            <li><span class="font-medium">Office:</span> <a class="link" href="tel:12077823001">(207) 782-3001</a></li>
            <li><span class="font-medium">Credit card assistance:</span> <a class="link" href="tel:12072526462">(207) 252-6462 (Dave)</a></li>
          </ul>
          <div class="mt-4 flex gap-2">
            <a href="tel:12072526462" class="btn btn-primary btn-sm">Call Dave</a>
            <a href="tel:12077823001" class="btn btn-outline btn-sm">Call Office</a>
          </div>
        </div>
      </div>

      <div class="alert bg-base-200">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 shrink-0" viewBox="0 0 24 24" fill="currentColor">
          <path fill-rule="evenodd" d="M12.723 2.116a.75.75 0 01.53.92l-1.237 5.154h5.234a.75.75 0 01.565 1.226l-9 11a.75.75 0 01-1.306-.671l1.238-5.154H3.75a.75.75 0 01-.565-1.226l9-11a.75.75 0 01.538-.249z" clip-rule="evenodd"/>
        </svg>
        <div>
          <h3 class="font-semibold">Thank you for your payment!</h3>
          <p class="text-sm text-base-content/70">We appreciate your prompt remittance.</p>
        </div>
      </div>
    </aside>

    <!-- Right: Credit card via PayPal + fee calculator -->
    <div class="lg:col-span-7 space-y-6">

      <div class="card bg-base-200 shadow-sm">
        <div class="card-body">
          <h2 class="card-title">Pay by Credit Card (via PayPal)</h2>
          <p class="text-base-content/80">
            You can pay by credit card using PayPal, or call our office and we can securely enter your card for you.
            <span class="font-medium">Please add 3.5% to cover the transaction cost.</span>
          </p>

          <!-- Simple fee calculator -->
          <div class="mt-4 grid md:grid-cols-3 gap-4 items-end">
            <div>
              <label class="label" for="amount"><span class="label-text">Invoice amount (before fee)</span></label>
              <input id="amount" type="number" min="0" step="0.01" class="input input-bordered w-full" placeholder="e.g. 500.00">
            </div>
            <div>
              <label class="label" for="withfee"><span class="label-text">Total with 3.5% fee</span></label>
              <input id="withfee" type="text" class="input input-bordered w-full" readonly>
            </div>
            <button id="calc" type="button" class="btn btn-primary md:mt-0">Calculate</button>
          </div>

          <!-- PayPal button placeholder -->
          <div class="mt-6">
            <!-- Replace href below with your PayPal hosted button link or PayPal.me link -->
            <a href="#" class="btn btn-primary btn-wide" id="paypalBtn" rel="noopener">
              Pay with PayPal
            </a>
            <p class="text-xs text-base-content/70 mt-2">After calculating, enter the <strong>Total with fee</strong> on the PayPal checkout screen.</p>
          </div>

          <p class="mt-4 text-sm text-base-content/70">
            Prefer paying by phone? Call <a class="link" href="tel:12072526462">(207) 252-6462</a> and weâ€™ll assist you.
          </p>
        </div>
      </div>

      <!-- Optional: Alternate methods / notes -->
      <div class="card bg-base-100 border border-base-300">
        <div class="card-body">
          <h3 class="font-semibold">Notes</h3>
          <ul class="list-disc pl-5 text-sm text-base-content/80 space-y-1">
            <li>Checks are preferred (no fee).</li>
            <li>Credit card payments include a 3.5% processing fee.</li>
            <li>For questions about your invoice, please call the office.</li>
          </ul>
        </div>
      </div>

    </div>
  </div>
</section>

<!-- Small inline script for the calculator -->
<script>
  (function () {
    const amount = document.getElementById('amount');
    const withfee = document.getElementById('withfee');
    const calc = document.getElementById('calc');
    const paypalBtn = document.getElementById('paypalBtn');

    function format(n) { return (Math.round(n * 100) / 100).toFixed(2); }

    calc?.addEventListener('click', function() {
      const val = parseFloat(amount.value || '0');
      if (isNaN(val) || val <= 0) {
        withfee.value = '';
        return;
      }
      const total = val * 1.035; // 3.5%
      withfee.value = format(total);
    });

    // If you use a PayPal.me link that accepts amount param, you can prefill:
    // Example: https://www.paypal.me/YourBusiness/{amount}
    // Replace '#' below with your PayPal.me base URL and uncomment.
    // paypalBtn?.addEventListener('click', function(e){
    //   const total = parseFloat(withfee.value || '0');
    //   if (total > 0) {
    //     e.preventDefault();
    //     window.location.href = `https://www.paypal.me/YourBusiness/${format(total)}`;
    //   }
    // });
  })();
</script>

{% endblock %}
